@model BANKFE.ViewModels.UserViewModel;
@{
    ViewData["Title"] = "Home Page";
}

@Html.Hidden("username", Model.Username, new { id = "username" })
<div class="container">
    <div class="m-3">
        <h3>Hello @Model.Username</h3>
    </div>

    <div class="card-deck">
        <partial name="Items/_AccountItem" model='new AccountItemModel { ControllerName = "Home", ActionName = "NotReadyPage" };' />
        <partial name="Items/_AccountItem" model='new AccountItemModel { ControllerName = "Home", ActionName = "NotReadyPage" };' />
    </div>

    <div style="width: 100%">
        <h3>Transaksi</h3>
        <table class="table table-sm table-borderless">
            <thead class="thead text-sm mb-5">
                <tr>
                    <th>Tanggal</th>
                    <th>Tipe Transaksi</th>
                    <th>Deskripsi</th>
                    <th>Nominal</th>
                </tr>
            </thead>

            <tbody class="table-light">
                <tr class="my-2">
                    <td>@DateTime.Now</td>
                    <td>Top up</td>
                    <td>Top up no id 123445678946</td>
                    <td>250.000,00</td>
                </tr>
                <tr class="my-2">
                    <td>@DateTime.Today</td>
                    <td>Top up</td>
                    <td>Top up no id 123445678946</td>
                    <td>500.000,00</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script src="~/lib/node-waves/waves.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"></script>

<script>
    $(document).ready(function () {
        if (@Model.IsValidate == true && @Model.IsActive == true) {
            Swal.fire({
                title: 'Selamat!',
                text: "Your account is verified",
                icon: 'success',
                showCancelButton: false,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Ok'
            }).then((result) => {
                var username = $("#username").val();
                console.log(username);
                $.ajax({
                    type: 'GET',
                    url: '/User/UpdateIsActive?username=' + username,
                    success: function (data) {
                        console.log("data: " + data);
                        Swal.fire("Success", "", "success");
                    },
                    error: function (data) {
                        console.log("data: " + data);
                        Swal.fire("Warning", data, "warning");
                    }
                });
            })
        } else {
            const Toast = Swal.mixin({
                toast: true,
                position: 'top-end',
                showConfirmButton: false,
                timer: 3000,
                timerProgressBar: true,
                didOpen: (toast) => {
                    toast.addEventListener('mouseenter', Swal.stopTimer)
                    toast.addEventListener('mouseleave', Swal.resumeTimer)
                }
            })

            Toast.fire({
                icon: 'success',
                title: 'Login success'
            })
        }
    });
    const showModal = () => {
        $('#generalModal').show();
    }

    const triggerActiveValue = delay => {
        setTimeout(() => {
            $.ajax({
                type: "POST",
                url: "Home/TriggerActiveFlag",
                data: @Model,
                contentType: "application/json; charset=utf-8",
                dataType: "text",
                success: response => {
                    console.log(response);
                },
                failure: response => {
                    console.log(response);
                },
                error: response => {
                    console.log(response);
                }
            });
            }, 500);
    };
</script>